{% extends 'base.html' %}
{% block content %}
<h2>Expense & Income Reports</h2>

<hr>

<!-- WEEKLY SUMMARY -->
<h4>Weekly Summary</h4>
<table border="1" cellpadding="8">
    <tr><th>Week Starting</th><th>Expenses (₹)</th><th>Incomes (₹)</th></tr>
    {% for week in expense_weekly %}
    <tr>
        <td>{{ week.week|date:"d M Y" }}</td>
        <td>{{ week.total }}</td>
        <td>
            {% for inc in income_weekly %}
                {% if inc.week == week.week %}
                    {{ inc.total }}
                {% endif %}
            {% endfor %}
        </td>
    </tr>
    {% empty %}
    <tr><td colspan="3">No weekly data available.</td></tr>
    {% endfor %}
</table>

<hr>

<!-- MONTHLY SUMMARY -->
<h4>Monthly Summary</h4>
<table border="1" cellpadding="8">
    <tr><th>Month</th><th>Expenses (₹)</th><th>Incomes (₹)</th></tr>
    {% for month in expense_monthly %}
    <tr>
        <td>{{ month.month|date:"M Y" }}</td>
        <td>{{ month.total }}</td>
        <td>
            {% for inc in income_monthly %}
                {% if inc.month == month.month %}
                    {{ inc.total }}
                {% endif %}
            {% endfor %}
        </td>
    </tr>
    {% empty %}
    <tr><td colspan="3">No monthly data available.</td></tr>
    {% endfor %}
</table>

<hr>

<!-- ANNUAL SUMMARY -->
<h4>Annual Summary</h4>
<table border="1" cellpadding="8">
    <tr><th>Year</th><th>Expenses (₹)</th><th>Incomes (₹)</th></tr>
    {% for year in expense_yearly %}
    <tr>
        <td>{{ year.year|date:"Y" }}</td>
        <td>{{ year.total }}</td>
        <td>
            {% for inc in income_yearly %}
                {% if inc.year == year.year %}
                    {{ inc.total }}
                {% endif %}
            {% endfor %}
        </td>
    </tr>
    {% empty %}
    <tr><td colspan="3">No yearly data available.</td></tr>
    {% endfor %}
</table>

<hr>

<!-- CATEGORY SUMMARY -->
<h4>Expense by Category</h4>
<table border="1" cellpadding="8">
    <tr><th>Category</th><th>Total (₹)</th></tr>
    {% for cat in expense_category %}
    <tr>
        <td>{{ cat.category__name }}</td>
        <td>{{ cat.total }}</td>
    </tr>
    {% empty %}
    <tr><td colspan="2">No category data available.</td></tr>
    {% endfor %}
</table>

<br>
<a href="{% url 'reports_pdf' %}" class="btn btn-primary">Download PDF Report</a>
{% endblock %}
